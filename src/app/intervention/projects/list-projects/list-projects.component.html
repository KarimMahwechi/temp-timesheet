<div id="app">
    <div class="main-content">
        <section class="section" style="margin-top:-2%;">
            <div class="section-body">
                <div class="row">
                    <div class="col-12 col-md-6 col-lg-12">
                        <div class="card card-light">
                            <div class="card-header" style="margin-top:1%;">
                                <h4><b> Liste de mes dépenses</b></h4>
                                <button class="btn btn-info float-end " style="position:absolute;right:50px;">Nouveau
                                    projet</button>
                                <button class="btn btn-outline-primary mb-2 me-2" (click)="openSm(content)">Small
                                    modal</button>

                            </div>
                            <!-- BEGIN : MODAL - ADD PROJECT -->
                            <ng-template #content let-modal>
                                <form [formGroup]="projectForm" (ngSubmit)="addProject()">
                                <div class="modal-header">
                                    <div class="form-group col-md-9" style="margin-bottom:0%;">
                                        <label class="modal-title" style="font-size: 16px;">Ajouter un projet </label>
                                    </div>
                                    <button type="button" class="btn-close" aria-label="Close"
                                        (click)="modal.dismiss('Cross click')"></button>
                                </div>
                                <div class="modal-body" style="margin-bottom:-5%;" >
                                    <div class="form-group">
                                        <div class="form-row">
                                            <div class="form-group col-md-6">
                                                <!--Nom-->
                                                <label>Nom du projet</label>
                                                <input type="text" class="form-control" id="inputTitre" formControlName="nameProject"
                                                [ngClass]="
                                                            (projectForm.get('nameProject')?.touched ||
                                                            projectForm.get('nameProject')?.dirty) &&
                                                            projectForm.get('nameProject')?.hasError('required')
                                                              ? 'is-invalid'
                                                              : '' ||
                                                              ((projectForm.get('nameProject')?.touched ||
                                                              projectForm.get('nameProject')?.dirty) &&
                                                              !projectForm.get('nameProject')?.invalid)
                                                                ? 'is-valid'
                                                                : ''
                                                            ">
                                                <div class="invalid-feedback">Nom du projet est obligatoire </div>
                                            </div>
                                            <div class="form-group col-md-6">
                                                <!--Priorité-->
                                                <label>Priorité</label>
                                                <select id="inputCategorie" class="custom-select form-control-sm" formControlName="priorityOfProject"
                                                [ngClass]="
                                                            (projectForm.get('priorityOfProject')?.touched ||
                                                            projectForm.get('priorityOfProject')?.dirty) &&
                                                            projectForm.get('priorityOfProject')?.hasError('required')
                                                              ? 'is-invalid'
                                                              : '' ||
                                                            ((projectForm.get('priorityOfProject')?.touched ||
                                                            projectForm.get('priorityOfProject')?.dirty) &&
                                                            !projectForm.get('priorityOfProject')?.invalid)
                                                              ? 'is-valid'
                                                              : ''
                                                            ">
                                                    <option value="élevé">Élevé</option>
                                                    <option value="normale">Normale</option>
                                                    <option value="faible">faible</option>
                                                </select>
                                                <div class="invalid-feedback">Indication du priorité du projet est obligatoire </div>
                                            </div>
                                        </div>
                                        <div class="form-row">
                                            <div class="form-group col-md-6">
                                                <!--Date limite-->
                                                <label>Date du création</label>
                                                <input type="date" class="form-control" formControlName="createdAtProject"
                                                [ngClass]="
                                                (projectForm.get('createdAtProject')?.touched ||
                                                projectForm.get('createdAtProject')?.dirty) &&
                                                projectForm.get('createdAtProject')?.hasError('required')
                                                  ? 'is-invalid'
                                                  : '' ||
                                                ((projectForm.get('createdAtProject')?.touched ||
                                                projectForm.get('createdAtProject')?.dirty) &&
                                                !projectForm.get('createdAtProject')?.invalid)
                                                  ? 'is-valid'
                                                  : ''
                                                ">
                                                <div class="invalid-feedback">L'indication de la date de création du projet est obligatoire </div>
                                            </div>
                                            <div class="form-group col-md-6">
                                                <!--Date limite-->
                                                <label>Date limilte</label>
                                                <input type="date" min="{{projectForm.get('createdAtProject')?.value | date:'yyyy-MM-dd'}}" class="form-control" formControlName="deadlineProject"
                                                [ngClass]="
                                                (projectForm.get('deadlineProject')?.touched ||
                                                projectForm.get('deadlineProject')?.dirty) &&
                                                projectForm.get('deadlineProject')?.hasError('required')
                                                  ? 'is-invalid'
                                                  : '' ||
                                                ((projectForm.get('deadlineProject')?.touched ||
                                                projectForm.get('deadlineProject')?.dirty) &&
                                                !projectForm.get('deadlineProject')?.invalid)
                                                  ? 'is-valid'
                                                  : ''
                                                ">
                                                <div class="invalid-feedback">L'indication de la date limite du projet est obligatoire </div>
                                            </div>
                                        </div>
                                        <div class="form-row">
                                            <div class="form-group col-md-12">
                                                <!--Description -->
                                                <label>Description du projet</label>
                                                <textarea id="descProjet" class="form-control" name="descProjet"rows="1" cols="13" formControlName="descProject"></textarea>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-light"
                                        (click)="modal.close('Close click')">Close</button>
                                    <button type="submit" class="btn btn-primary"
                                        [disabled]="projectForm.invalid"
                                        (click)="modal.close('Close click')">Sauvgarder</button>
                                </div>
                            </form>
                            </ng-template>
                            <!-- END : MODAL - ADD PROJECT-->
                            <div class="card-body" style="margin-top:-1%;">
                                <input type="search" class="form-control" name="categorie" placeholder="Enter your name"
                                    [(ngModel)]="searchedProject" (ngModelChange)="Search()" />
                                <font size="2">
                                    <table width="100%" class="table  table-light table-hover table-md" id="albums"
                                        cellspacing="0" border="1px">
                                        <thead>
                                            <tr class="spaceUnder" border="1px">
                                                <th (click)="sortField('nameProject')">Titre &nbsp; <i
                                                        class="fa-solid fa-sort"></i></th>
                                                <th (click)="sortField('descProject')"> Description &nbsp; <i
                                                        class="fa-solid fa-sort"></i></th>
                                                <th (click)="sortField('createdAtProject')">Date du création &nbsp; <i
                                                        class="fa-solid fa-sort"></i></th>
                                                <th (click)="sortField('expiredAtProject')">Date d'éxpiration &nbsp; <i
                                                        class="fa-solid fa-sort"></i></th>
                                                <th (click)="sortField('deadlineProject')">Date limite &nbsp; <i
                                                        class="fa-solid fa-sort"></i></th>
                                                <th (click)="sortField('stateOfProject')">Statu &nbsp; <i
                                                        class="fa-solid fa-sort"></i></th>
                                                <th (click)="sortField('priorityOfProject')"> Priorité &nbsp; <i
                                                        class="fa-solid fa-sort"></i></th>
                                                <th>Action</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr class="spaceUnder"
                                                *ngFor="let project of projectsList |orderBy: key: reverse | paginate: {itemsPerPage: 10 , currentPage : p} ;">
                                                <td style="width:10%;"> {{ project.nameProject }}</td>
                                                <td style="width:15%;"> {{ project.descProject }}</td>
                                                <td style="width:12%;"> {{ project.createdAtProject }} </td>
                                                <td style="width:12%;">
                                                    {{ project.expiredAtProject }}
                                                </td>
                                                <td style="width:10%;">
                                                    {{ project.deadlineProject }}
                                                </td>
                                                <td style="width:0%;text-align:center;">
                                                    <div class="badge badge-success badge-shadow ">{{
                                                        project.stateOfProject
                                                        }}</div>
                                                </td>
                                                <td style="width:5%;text-align:center;">
                                                    <div class="badge badge-warning badge-shadow">{{
                                                        project.priorityOfProject
                                                        }}</div>
                                                </td>
                                                <td style="width:10%">
                                                    <!--<a href="#" id="btn1"
                                                        class="btn btn-sm btn-primary "
                                                        style=" margin : auto ; display:inline-block;justify-content: center;">Detail</a>
                                                    <a href="#" id="btn1"
                                                        class="btn btn-sm btn-outline "
                                                        style=" margin : auto ; display:inline-block;justify-content: center;">Detail</a>-->

                                                    <button type="button" class="btn btn-outline-info btn-sm"><i
                                                            class="fa-solid fa-trash-can"></i></button>
                                                    &nbsp;
                                                    <button type="button" class="btn btn-outline-info btn-sm "><i
                                                            class="fa-solid fa-pen-to-square"></i></button>

                                                </td>
                                            </tr>
                                        </tbody>
                                        <!--padding-left:20%;padding-right:20%;-->
                                        <!--<pagination-controls (pageChange)="p = $event" previousLabel="" nextLabel=""></pagination-controls>-->
                                    </table>
                                </font>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
</div>